'use strict';require('../setupBabel')();var e=require('@react-native-community/cli/node_modules/metro-react-native-babel-transformer/src/index.js'),r=require('path'),i=require("fs"),n=require("./common"),t=n.project_dir,o=n.DEV,u=require('../fixbug'),s=e.transform,a={getCacheKey:e.getCacheKey},c=new Map;function f(e){e&&'string'!=typeof e&&(e.modules||[]).forEach(function(e){c.set(e[1],e[0])})}var l={"modules":[]};function m(){if(!c.size&&l&&(f(l),l=null,c.size<1&&p())){var e=r.join(t,"bin","config","modules_sdk"),n=i.existsSync(e)?i.readFileSync(e):null;n&&(f(JSON.parse(n.toString()||"{}")),n=null)}}function p(){return!o||!a._miot_building}a.transform=function(e){m();var i=r.relative(t,e.filename),n=i.replace(/\\/g,"/");if(a._miot_fixbug){var o=a._miot_fixbug(n,e,s);if(o)return o}var f=u.findContent(n);if(f)return console.log("FIXBUG",i),e.src=f.toString(),s(e);if(p()){var l=i.replace(/\\/g,"/"),g=c.get(l);if(g)return e.src=g,e.options.dev=!1,e.options.hot=!1,e.options.minify=!0,e.options.enableBabelRCLookup=!1,e.options.inlineRequires=!0,s(e)}return s(e)},module.exports=a;